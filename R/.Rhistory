X = as.matrix(cbind(iota,temp[,-c(1:3)]))
y = log(temp[,3])
regdata[[i]]=list(y=y,X=X)
}
Data1=list(regdata=regdata)
Mcmc1=list(R=R,keep=1)
#Prior1=list(Deltabar=Delta,A=0.01*diag(1),nu.e=3,ssq=rep(0.06,ns),nu=6,V=6*0.1*diag(3))
#out=rhierLinearModel(Data=Data1,Prior=Prior1, Mcmc=Mcmc1)
out=rhierLinearModel(Data=Data1, Mcmc=Mcmc1)    # 실제 regression
cat("Summary of Delta draws",fill=TRUE)
summary(out$Deltadraw)
cat("Summary of Vbeta draws",fill=TRUE)
summary(out$Vbetadraw)
tempb1 = out$betadraw[,2,5001:10000] #초기 5000개 값 제외
tempb2 = out$betadraw[,3,5001:10000]
cbind(cat_list,rowMeans(tempb1),apply(tempb1,1,sd),rowMeans(tempb2),apply(tempb2,1,sd))
out
out$betadraw[,,1]
out$betadraw[1,,1]
dim(out$betadraw)
bayes = out
dim(out$betadraw)[2]
as.data.frame(cat_list)
rd_train[rd_train[,i+66]==1,-c(4,7:9,68:75)]
betaout = as.data.frame(matrix(ncol = length(cat_list), nrow = dim(out$betadraw)[2]))
colnames(betaout) = c('caegory', '(intercept)', colnames(rd_train[,-c(1:3)]))
betaout = as.data.frame(matrix(nrow = length(cat_list), ncol = dim(out$betadraw)[2]))
colnames(betaout) = c('caegory', '(intercept)', colnames(rd_train[,-c(1:3)]))
c('caegory', '(intercept)', colnames(rd_train[,-c(1:3)]))
colnames(betaout) = c('category', '(intercept)', colnames(rd_train[,-c(1:3)]))
X
ncol(X)
colnames(betaout) = c('category', '(intercept)', colnames(rd_train[,-c(1:3,68:75)]))
betaout = as.data.frame(matrix(nrow = length(cat_list), ncol = dim(out$betadraw)[2])+1)
colnames(betaout) = c('category',  colnames(rd_train[,-c(1:3,68:75)]))
colnames(betaout) = c('category',  colnames(rd_train[,-c(1:3,7:9, 68:75)]))
betaout = as.data.frame(matrix(nrow = length(cat_list), ncol = dim(out$betadraw)[2])+1)
colnames(betaout) = c('category',  colnames(rd_train[,-c(1:3,7:9, 68:75)]))
dim(out$betadraw)[2])+1
betaout = as.data.frame(matrix(nrow = length(cat_list), ncol = dim(out$betadraw)[2]+1))
colnames(betaout) = c('category',  colnames(rd_train[,-c(1:3,7:9, 68:75)]))
betaout[,1] = cat_list
betaout
betaout
bayes_beta = as.data.frame(matrix(nrow = length(cat_list), ncol = dim(out$betadraw)[2]+1))
colnames(bayes_beta) = c('category',  '(intercept)', colnames(rd_train[,-c(1:4,7:9, 68:75)]))
bayes_beta[,1] = cat_list
bayes_sd = bayes_beta
bayes_beta[,1]
bayes_beta[,2]
as.data.frame(bayes$betadraw[,1,5001:10000])
rowMeans(bayes$betadraw[,1,5001:10000])
for(i in 1:dim(out$betadraw)[2]){
temp = bayes$betadraw[,i,5001:10000]
bayes_beta[,i+1] = rowMeans(temp)
bayes_sd[,i+1] = apply(tempb,1,sd)
}
bayes_sd[,i+1] = apply(temp,1,sd)
for(i in 1:dim(out$betadraw)[2]){
temp = bayes$betadraw[,i,5001:10000]
bayes_beta[,i+1] = rowMeans(temp)
bayes_sd[,i+1] = apply(temp,1,sd)
}
bayes_beta
print(bayes_beta)
for(i in 1:dim(bayes$betadraw)[2]){
assign(paste('bayes_draw_',i,sep=''), bayes$betadraw[,i,5001:10000])
bayes_beta[,i+1] = rowMeans(get(paste('bayes_draw_',i,sep='')))
bayes_sd[,i+1] = apply(get(paste('bayes_draw_',i,sep='')),1,sd)
}
beta_list = colnames(bayes_beta[,-1])
bayes_draw_1
boxplot(bayes_draw_1~c(1:9),horizontal=F,col="lightblue",
main="Price Elasticity by Stores", ylab="Price Elasticity", xlab="Store",
outline=F, ylim=c(-5,-1.5))
boxplot(bayes_draw_1~c(1:9),horizontal=F,col="lightblue",
main="Price Elasticity by Stores", ylab="Price Elasticity", xlab="Store",
outline=F)
boxplot(bayes_draw_2~c(1:9),horizontal=F,col="lightblue",
main="Price Elasticity by Stores", ylab="Price Elasticity", xlab="Store",
outline=F)
beta_list
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = bayes_draw_63)
as.data.frame(bayes_draw_63)
ggplot(mpg, aes(class, hwy))
mpg
melt(as.data.frame(bayes_draw_63))
cbind(cat_list, as.data.frame(bayes_draw_63))
melt(cbind(cat_list, as.data.frame(bayes_draw_63)), id.vars = cat_list)
melt(cbind(cat_list, as.data.frame(bayes_draw_63)), variable.name = cat_list)
data.frame(cond = factor(rep(c("A","B"), each=200)), rating = c(rnorm(200),rnorm(200, mean=.8)))
bayes_draw_63
cbind(cat_list, as.data.frame(bayes_draw_63))
geom_boxplot(data = as.data.frame(bayes_draw_63),
melt(as.data.frame(t(bayes_draw_63)))
melt(as.data.frame(t(bayes_draw_63)))
melt(as.data.frame(t(bayes_draw_63)))
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(as.data.frame(t(bayes_draw_63))), aes(x=variable))
melt(as.data.frame(t(bayes_draw_63))
ggplot(lm_coefficients[-1,], aes(x = category)) +
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(as.data.frame(t(bayes_draw_63))), aes(x=variable, y = value))
as.data.frame(t(bayes_draw_63), colnames = cat_list)
data.frame(t(bayes_draw_63), colnames = cat_list)
data.frame(t(bayes_draw_63))
data.frame(t(bayes_draw_63), colnames = cat_list)
data.frame(t(bayes_draw_63))%>% colnames = cat_list
library(dplyr)
data.frame(t(bayes_draw_63))%>% colnames = cat_list
as.data.frame(t(bayes_draw_63), colnames = cat_list)
t(as.data.frame(bayes_draw_63, rownames = cat_list))
as.data.frame(bayes_draw_63, rownames = cat_list)
cat_list
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
#geom_boxplot(data = melt(as.data.frame(t(bayes_draw_63))), aes(x=variable, y = value))
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F)
bayes_beta
lm_coefficients
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(as.data.frame(t(bayes_draw_63))), aes(y = value))
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(as.data.frame(t(bayes_draw_63))), aes(x=variable, y = value))
a = as.data.frame(t(bayes_draw_63))
colnames(a) = cat_list
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = a), aes(x=cat_list, y = value))
a
melt(a)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value))
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 1)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 'Pastel')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 'Pastel1')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 'Paired')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 'lightblue')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 'lightgreen')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 'emelard')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 'cotton')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = factor(1))
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 12)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 10)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 7)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 9)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 8)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 4)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = "#E69F00")
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = "#E69F00") +
scale_fill_brewer(palette = 'Pastel')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = "#E69F00") +
scale_fill_brewer(palette = 'Paird')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = "#E69F00") +
scale_fill_brewer(palette = 'Paired')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = "#E69F00") +
scale_fill_brewer(palette = 'Dark2')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = NA) +
scale_fill_brewer(palette = 'Dark2')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = 1) +
scale_fill_brewer(palette = 'Dark2')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = variable) +
scale_fill_brewer(palette = 'Dark2')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = dose) +
scale_fill_brewer(palette = 'Dark2')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value), fill = factor(a)) +
scale_fill_brewer(palette = 'Dark2')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(variable, y = value, fill = factor(a))) +
scale_fill_brewer(palette = 'Dark2')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(x = variable, y = value, fill = factor(a))) +
scale_fill_brewer(palette = 'Dark2')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = melt(a), aes(x = variable, y = value, fill = factor('a'))) +
scale_fill_brewer(palette = 'Dark2')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, fill = F, size = F) +
geom_boxplot(data = melt(a), aes(x = variable, y = value, fill = factor('a'))) +
scale_fill_brewer(palette = 'Dark2')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, fill = F, size = F) +
geom_boxplot(data = melt(a), aes(x = variable, y = value, fill = factor('a'))) +
scale_fill_brewer(palette = 'Pastel')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, fill = F, size = F) +
geom_boxplot(data = melt(a), aes(x = variable, y = value, fill = factor('a'))) +
scale_fill_brewer(palette = 'Paired')
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, fill = F, size = F) +
geom_boxplot(data = melt(a), aes(x = variable, y = value, fill = factor('a'))) +
scale_fill_brewer(palette = 'Pastel1')
beta_list
base_price_MCMC = as.data.frame(t(bayes_draw_63)); colnames(base_price_MCMC) = cat_list; base_price_MCMC = melt(base_price_MCMC)
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, fill = F, size = F) +
geom_boxplot(data = base_price_MCMC, aes(x = variable, y = value, fill= 'a')) +
scale_fill_brewer(palette = 'Pastel2')
beta_list
sale_event_MCMC = as.data.frame(t(bayes_draw_2)); colnames(sale_event_MCMC) = cat_list; sale_event_MCMC = melt(sale_event_MCMC)
promo_addition_MCMC = as.data.frame(t(bayes_draw_14)); colnames(promo_addition_MCMC) = cat_list; promo_addition_MCMC = melt(promo_addition_MCMC)
promo_addition_MCMC
grid.arrange(
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,2], linetype = 'pooled OLS')) +
geom_point(aes(y = base_price, col = 'red')) +
geom_line(aes(y = base_price, col = 'red', group = 1)) +
labs(title ='effect of base_price in different OLS models', linetype = 'baseline') +
guides(col=FALSE, fill = F, size = F) +
geom_boxplot(data = base_price_MCMC, aes(x = variable, y = value, fill= 'a')) +
scale_fill_brewer(palette = 'Pastel2'),
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,3], linetype = 'pooled OLS')) +
geom_point(aes(y = sale_event, col = 'red')) +
geom_line(aes(y = sale_event, col = 'red', group = 1)) +
labs(title ='effect of sale_event in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = sale_event_MCMC, aes(x = variable, y = value, fill= 'a')) +
scale_fill_brewer(palette = 'Pastel2'),
ggplot(lm_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = lm_coefficients[1,4], linetype = 'pooled OLS')) +
geom_point(aes(y = promo3_addition, col = 'red')) +
geom_line(aes(y = promo3_addition, col = 'red', group = 1)) +
labs(title ='effect of promo_addition in different OLS models', linetype = 'baseline') +
guides(col=FALSE, size = F) +
geom_boxplot(data = promo_addition_MCMC, aes(x = variable, y = value, fill= 'a')) +
scale_fill_brewer(palette = 'Pastel2'),
nrow = 3)
ggplot(ridge_coefficients[-1,], aes(x = category)) +
geom_hline(aes(yintercept = ridge_coefficients[1,4], linetype = 'pooled ridge')) +
geom_point(aes(y = promo3_addition, col = 'red')) +
geom_line(aes(y = promo3_addition, col = 'red', group = 1)) +
labs(title ='effect of promo_addition in different ridge models', linetype = 'baseline') +
geom_boxplot(data = promo_addition_MCMC, aes(x = variable, y = value, fill= 'a')) +
scale_fill_brewer(palette = 'Pastel2')+
guides(col=FALSE, fill = F, size = F)
bayes_beta
bayes_beta = as.data.frame(matrix(nrow = length(cat_list)+1, ncol = dim(out$betadraw)[2]+1))
colnames(bayes_beta) = c('category',  '(intercept)', colnames(rd_train[,-c(1:4,7:9, 68:75)]))
bayes_beta[,1] = c('cat_base', cat_list)
bayes_sd = bayes_beta
for(i in 1:dim(bayes$betadraw)[2]){
assign(paste('bayes_draw_',i,sep=''), bayes$betadraw[,i,5001:10000])
bayes_beta[,i+1] = rowMeans(get(paste('bayes_draw_',i,sep='')))
bayes_sd[,i+1] = apply(get(paste('bayes_draw_',i,sep='')),1,sd)
}
bayes_beta = as.data.frame(matrix(nrow = length(cat_list), ncol = dim(out$betadraw)[2]+1))
colnames(bayes_beta) = c('category',  '(intercept)', colnames(rd_train[,-c(1:4,7:9, 68:75)]))
bayes_beta[,1] =  cat_list
bayes_sd = bayes_beta
for(i in 1:dim(bayes$betadraw)[2]){
assign(paste('bayes_draw_',i,sep=''), bayes$betadraw[,i,5001:10000])
bayes_beta[,i+1] = rowMeans(get(paste('bayes_draw_',i,sep='')))
bayes_sd[,i+1] = apply(get(paste('bayes_draw_',i,sep='')),1,sd)
}
beta_list = colnames(bayes_beta[,-1])
rm(list=c(a, b))
rm(c(a, b))
rm(a)
rm(b)
rm(tempb1)
rm(tempb2)
rm(z)
rm(out)
save.image("D:/CNS_DATA/(180124)working_env.RData")
